<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="mobile.css" />
		<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

		<title>GPS Locate</title>
		<meta name="description" content="This app allows you to create CSV file for import into HistoryPin.org Website">
		<meta name="author" content="Amy Sorensen">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

		<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
		<link rel="shortcut icon" href="/favicon.ico">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		
	</head>

	<body>
		    
		<div>
			<header>
				<h1>GPS Locate</h1>
			</header>
					<button onclick="getLocation()">Locate</button>
					<p id="gnss">
					</p>
					<div id="map">
					</div>
					<p><a href="start.html">Locate Another Photo</a></p>
					<p><a href="ExportCSV.html">Done Adding Photos. Export CSV File</a></p>
			
			<script src="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>
			<script type="text/javascript">
		
			var x = document.getElementById("gnss");
			
			function getLocation() {
    			if (navigator.geolocation) {
   	    		 navigator.geolocation.getCurrentPosition(showPosition);
   	 		 } else {
    	  		  x.innerHTML = "Geolocation is not supported by this browser.";
   			 }
   			 
			function showPosition(position)
 			 {
 			 var xLat = position.coords.latitude;
 			 var yLong = position.coords.longitude;
 			 x.innerHTML= "Latitude: " + xLat + "<br>Longitude: " + yLong;
 			 
 			 //Local Storage add X & Y to the name and store
 			 var XdataToStore = JSON.stringify(xLat);
 			 var YdataToStore = JSON.stringify(yLong);
 			 var localNameData = JSON.parse(localStorage.getItem('nameData'));
  			 var dataToStore = localNameData+", "+XdataToStore+", "+YdataToStore+"\r";
  			 localStorage.setItem('oneFile', dataToStore); 
  			}
  			
  			  			
  			//Map
			var map = L.map('map');
			
			L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
				'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
			id: 'examples.map-i875mjb7'
			}).addTo(map);

			map.locate({setView: true, maxZoom:16});
		
			L.polygon([
				[51.509, -0.08],
				[51.503, -0.06],
				[51.51, -0.047]
			]).addTo(map).bindPopup("I am a polygon.");


			var popup = L.popup();

		function onMapClick(e) {
			popup
				.setLatLng(e.latlng)
				.setContent("You clicked the map at " + e.latlng.toString())
				.openOn(map);
		}

		map.on('click', onMapClick);

 			 }
 		//var localData = JSON.parse(localStorage.getItem('oneFile'));
 		//window.alert(localData);
		</script>
			<footer>
				<p>
					<input name="Home" type="button" value="Home" onclick="parent.location='index.html'" />
				</p>
				<p>
					&copy; Copyright Amy Sorensen
				</p>
			</footer>
		</div>
	</body>
</html>
